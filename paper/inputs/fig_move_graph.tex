%!TEX root = ../egpaper_for_review.tex
\begin{figure*}

\tikzstyle{vert}=[circle,minimum size = 0.5cm,inner sep = 1pt,draw, font=\small,align=left]
\centering
%\begin{subfigure}[t]{1\linewidth}
   \resizebox{0.8\linewidth}{!}{
      \begin{tikzpicture}[scale=1.0,transform shape]
        \tikzstyle{vert}=[circle,minimum size = 0.5cm,inner sep = 0pt,draw, font=\small, node distance = 5cm,align=left]


       
        \draw (0*2,4+3*2) node[vert,fill=red!50](1){$1$};
        \draw (1*2,4+3*2) node[vert,fill=red!50](2){$2$};
        \draw (2*2,4+3*2) node[vert,fill=red!50](3){$3$};
        \draw (3*2,4+3*2) node[vert,fill=red!50](4){$4$};
        \draw (0*2,4+2*2) node[vert,fill=red!50](5){$5$};
        \draw (1*2,4+2*2) node[vert,fill=red!50](6){$6$};
        \draw (2*2,4+2*2) node[vert,fill=red!50](7){$7$};
        \draw (3*2,4+2*2) node[vert,fill=red!50](8){$8$};
        \draw (0*2,4+1*2) node[vert,fill=blue!50](9){$9$};
        \draw (1*2,4+1*2) node[vert,fill=blue!50](10){$10$};
        \draw (2*2,4+1*2) node[vert,fill=blue!50](11){$11$};
        \draw (3*2,4+1*2) node[vert,fill=blue!50](12){$12$};
        \draw (0*2,4+0*2) node[vert,fill=blue!50](13){$13$};
        \draw (1*2,4+0*2) node[vert,fill=blue!50](14){$14$};
        \draw (2*2,4+0*2) node[vert,fill=blue!50](15){$15$};
        \draw (3*2,4+0*2) node[vert,fill=blue!50](16){$16$};
        %
        \path[every node/.style={font=\sffamily\tiny, fill=white}]
            (1)     edge[eNotCut]     node{$w_{(1, 2)}$   }     (2)
            (2)     edge[eNotCut]     node{$w_{(2, 3)}$   }     (3)
            (3)     edge[eNotCut]     node{$w_{(3, 4)}$   }     (4)
            (5)     edge[eNotCut]     node{$w_{(5, 6)}$   }     (6)
            (6)     edge[eNotCut]     node{$w_{(6, 7)}$   }     (7)
            (7)     edge[eNotCut]     node{$w_{(7, 8)}$   }     (8)
            (9)     edge[eNotCut]     node{$w_{(9, 10)}$  }     (10)
            (10)    edge[eNotCut]     node{$w_{(10, 11)}$ }     (11)
            (11)    edge[eNotCut]     node{$w_{(11, 12)}$ }     (12)
            (13)    edge[eNotCut]     node{$w_{(13, 14)}$ }     (14)
            (14)    edge[eNotCut]     node{$w_{(14, 15)}$ }     (15)
            (15)    edge[eNotCut]     node{$w_{(15, 16)}$ }     (16)
            (1)     edge[eNotCut]     node{$w_{(1, 5)}$   }     (5)
            (5)     edge[eCut]     node{$w_{(5, 9)}$   }     (9)
            (9)     edge[eNotCut]     node{$w_{(9, 13)}$  }     (13)
            (2)     edge[eNotCut]     node{$w_{(2, 6)}$   }     (6)
            (6)     edge[eCut]     node{$w_{(6, 10)}$  }     (10)
            (10)    edge[eNotCut]     node{$w_{(10, 14)}$ }     (14)
            (3)     edge[eNotCut]     node{$w_{(3, 7)}$   }     (7)
            (7)     edge[eCut]     node{$w_{(7, 11)}$  }     (11)
            (11)    edge[eNotCut]     node{$w_{(11, 15)}$ }     (15)
            (4)     edge[eNotCut]     node{$w_{(4, 8)}$   }     (8)
            (8)     edge[eCut]     node{$w_{(8, 12)}$  }     (12)
            (12)    edge[eNotCut]     node{$w_{(12, 16)}$ }     (16)
        ;
        \draw (3+0*2,3*2-3) node[minimum size=2cm,font=\sffamily\Huge] (dummy){$\textbf{+}$};
        %\draw (15+0*2,3*2-4) node[minimum size=2cm,font=\sffamily\Huge] (dummy){$\rightarrow$};

        \draw (0*2,-4+3*2) node[vert,fill=green!50](1){$1$};
        \draw (1*2,-4+3*2) node[vert,fill=orange!50](2){$2$};
        \draw (2*2,-4+3*2) node[vert,fill=orange!50](3){$3$};
        \draw (3*2,-4+3*2) node[vert,fill=orange!50](4){$4$};
        \draw (0*2,-4+2*2) node[vert,fill=yellow!=30](5){$5$};
        \draw (1*2,-4+2*2) node[vert,fill=magenta!40](6){$6$};
        \draw (2*2,-4+2*2) node[vert,fill=magenta!40](7){$7$};
        \draw (3*2,-4+2*2) node[vert,fill=magenta!40](8){$8$};
        \draw (0*2,-4+1*2) node[vert,fill=yellow!=30](9){$9$};
        \draw (1*2,-4+1*2) node[vert,fill=magenta!40](10){$10$};
        \draw (2*2,-4+1*2) node[vert,fill=magenta!40](11){$11$};
        \draw (3*2,-4+1*2) node[vert,fill=magenta!40](12){$12$};
        \draw (0*2,-4+0*2) node[vert,fill=yellow!=30](13){$13$};
        \draw (1*2,-4+0*2) node[vert,fill=magenta!40](14){$14$};
        \draw (2*2,-4+0*2) node[vert,fill=magenta!40](15){$15$};
        \draw (3*2,-4+0*2) node[vert,fill=magenta!40](16){$16$};
        %
        \path[every node/.style={font=\sffamily\tiny, fill=white}]
            (1)     edge[eCut]     node{$w_{(1, 2)}$   }     (2)
            (2)     edge[eNotCut]     node{$w_{(2, 3)}$   }     (3)
            (3)     edge[eNotCut]     node{$w_{(3, 4)}$   }     (4)
            (5)     edge[eCut]     node{$w_{(5, 6)}$   }     (6)
            (6)     edge[eNotCut]     node{$w_{(6, 7)}$   }     (7)
            (7)     edge[eNotCut]     node{$w_{(7, 8)}$   }     (8)
            (9)     edge[eCut]     node{$w_{(9, 10)}$  }     (10)
            (10)    edge[eNotCut]     node{$w_{(10, 11)}$ }     (11)
            (11)    edge[eNotCut]     node{$w_{(11, 12)}$ }     (12)
            (13)    edge[eCut]     node{$w_{(13, 14)}$ }     (14)
            (14)    edge[eNotCut]     node{$w_{(14, 15)}$ }     (15)
            (15)    edge[eNotCut]     node{$w_{(15, 16)}$ }     (16)
            (1)     edge[eCut]     node{$w_{(1, 5)}$   }     (5)
            (5)     edge[eNotCut]     node{$w_{(5, 9)}$   }     (9)
            (9)     edge[eNotCut]     node{$w_{(9, 13)}$  }     (13)
            (2)     edge[eCut]     node{$w_{(2, 6)}$   }     (6)
            (6)     edge[eNotCut]     node{$w_{(6, 10)}$  }     (10)
            (10)    edge[eNotCut]     node{$w_{(10, 14)}$ }     (14)
            (3)     edge[eCut]     node{$w_{(3, 7)}$   }     (7)
            (7)     edge[eNotCut]     node{$w_{(7, 11)}$  }     (11)
            (11)    edge[eNotCut]     node{$w_{(11, 15)}$ }     (15)
            (4)     edge[eCut]     node{$w_{(4, 8)}$   }     (8)
            (8)     edge[eNotCut]     node{$w_{(8, 12)}$  }     (12)
            (12)    edge[eNotCut]     node{$w_{(12, 16)}$ }     (16)
        ;
        
        \draw (7+0*2,3*2-3) node[minimum size=2cm,font=\sffamily\Huge] (dummy){$\textbf{=}$};

        \draw (8+0*2,3*2) node[vert,fill=blue!50!green](1){$1$};
        \draw (8+1*2,3*2) node[vert,fill=brown!50](2){$2$};
        \draw (8+2*2,3*2) node[vert,fill=brown!50](3){$3$};
        \draw (8+3*2,3*2) node[vert,fill=brown!50](4){$4$};
        \draw (8+0*2,2*2) node[vert,fill=cyan!=30](5){$5$};
        \draw (8+1*2,2*2) node[vert,fill=red!50!lime](6){$6$};
        \draw (8+2*2,2*2) node[vert,fill=red!50!lime](7){$7$};
        \draw (8+3*2,2*2) node[vert,fill=red!50!lime](8){$8$};
        \draw (8+0*2,1*2) node[vert,fill=violet!60](9){$9$};
        \draw (8+1*2,1*2) node[vert,fill=lime!40](10){$10$};
        \draw (8+2*2,1*2) node[vert,fill=lime!40](11){$11$};
        \draw (8+3*2,1*2) node[vert,fill=lime!40](12){$12$};
        \draw (8+0*2,0*2) node[vert,fill=violet!60](13){$13$};
        \draw (8+1*2,0*2) node[vert,fill=lime!40](14){$14$};
        \draw (8+2*2,0*2) node[vert,fill=lime!40](15){$15$};
        \draw (8+3*2,0*2) node[vert,fill=lime!40](16){$16$};
        %
        \path[every node/.style={font=\sffamily\tiny, fill=white}]
            (1)     edge[eCut]     node{$w_{(1, 2)}$   }     (2)
            (2)     edge[eNotCut]     node{$w_{(2, 3)}$   }     (3)
            (3)     edge[eNotCut]     node{$w_{(3, 4)}$   }     (4)
            (5)     edge[eCut]     node{$w_{(5, 6)}$   }     (6)
            (6)     edge[eNotCut]     node{$w_{(6, 7)}$   }     (7)
            (7)     edge[eNotCut]     node{$w_{(7, 8)}$   }     (8)
            (9)     edge[eCut]     node{$w_{(9, 10)}$  }     (10)
            (10)    edge[eNotCut]     node{$w_{(10, 11)}$ }     (11)
            (11)    edge[eNotCut]     node{$w_{(11, 12)}$ }     (12)
            (13)    edge[eCut]     node{$w_{(13, 14)}$ }     (14)
            (14)    edge[eNotCut]     node{$w_{(14, 15)}$ }     (15)
            (15)    edge[eNotCut]     node{$w_{(15, 16)}$ }     (16)
            (1)     edge[eCut]     node{$w_{(1, 5)}$   }     (5)
            (5)     edge[eCut]     node{$w_{(5, 9)}$   }     (9)
            (9)     edge[eNotCut]     node{$w_{(9, 13)}$  }     (13)
            (2)     edge[eCut]     node{$w_{(2, 6)}$   }     (6)
            (6)     edge[eCut]     node{$w_{(6, 10)}$  }     (10)
            (10)    edge[eNotCut]     node{$w_{(10, 14)}$ }     (14)
            (3)     edge[eCut]     node{$w_{(3, 7)}$   }     (7)
            (7)     edge[eCut]     node{$w_{(7, 11)}$  }     (11)
            (11)    edge[eNotCut]     node{$w_{(11, 15)}$ }     (15)
            (4)     edge[eCut]     node{$w_{(4, 8)}$   }     (8)
            (8)     edge[eCut]     node{$w_{(8, 12)}$  }     (12)
            (12)    edge[eNotCut]     node{$w_{(12, 16)}$ }     (16)
        ;


        \draw (17+0*2,    3*2) node[vert](1){$\{1\}$};
        \draw (17+2*2,    3*2) node[vert](2){$\{2, 3, 4\}$};
        \draw (17+0*2,    2*2) node[vert,](5){$\{5\}$};
        \draw (17+2*2,    2*2) node[vert](6){$\{6, 7, 8\}$};
        \draw (17+0*2,    1*2) node[vert](9){$\{9, 13\}$};
        \draw (17+2*2,1*2) node[vert ](10){$\{10, 11, 12,$\\$14, 15, 16\}$};
        %
        \path[every node/.style={font=\sffamily\tiny, fill=white}]
            (1)     edge[eNotCut]     node{$w_{(1, 2)}$   }     (2)
            (1)     edge[eNotCut]     node{$w_{(1, 5)}$   }     (5)
            (1)     edge[eNotCut]     node{$w_{(1, 5)}$   }     (5)
            (5)     edge[eNotCut]     node{$w_{(5, 6)}$   }     (6)
            (5)     edge[eNotCut]     node{$w_{(5, 9)}$   }     (9)
            (9)     edge[eNotCut]     node{$w_{(9, 10)} + w_{(13, 14)}$   }     (10)
            (2)     edge[eNotCut]     node{$w_{(2, 6)} + w_{(3, 7)} + w_{(4, 8)} $   }     (6)
            (6)     edge[eNotCut]     node{$w_{(6, 10)} + w_{(7, 11)} + w_{(8, 12)} $   }     (10)
        ;



        \draw (25+0*2,0+3*2) node[vert,fill=blue!20!cyan](1){$\{1\}$};
        \draw (25+2*2,0+3*2) node[vert,fill=green!30!cyan](2){$\{2, 3, 4\}$};
        \draw (25+0*2,0+2*2) node[vert,fill=blue!20!cyan ](5){$\{5\}$};
        \draw (25+2*2,0+2*2) node[vert,fill=blue!40!green](6){$\{6, 7, 8\}$};
        \draw (25+0*2,0+1*2) node[vert,fill=blue!40!green](9){$\{9, 13\}$};
        \draw (25+2*2,0+ 1*2) node[vert,fill=blue!40!green](10){$\{10, 11, 12,$\\$14, 15, 16\}$};
        %
        \path[every node/.style={font=\sffamily\tiny, fill=white}]
            (1)     edge[eCut]     node{$w_{(1, 2)}$   }     (2)
            (1)     edge[eCut]     node{$w_{(1, 5)}$   }     (5)
            (1)     edge[eNotCut]     node{$w_{(1, 5)}$   }     (5)
            (5)     edge[eCut]     node{$w_{(5, 6)}$   }     (6)
            (5)     edge[eCut]     node{$w_{(5, 9)}$   }     (9)
            (9)     edge[eNotCut]     node{$w_{(9, 10)} + w_{(13, 14)}$   }     (10)
            (2)     edge[eCut]     node{$w_{(2, 6)} + w_{(3, 7)} + w_{(4, 8)} $   }     (6)
            (6)     edge[eNotCut]     node{$w_{(6, 10)} + w_{(7, 11)} + w_{(8, 12)} $   }     (10)
        ;



        \draw (33+0*2,0+3*2) node[vert,fill=blue!20!cyan](1){$1$};
        \draw (33+1*2,0+3*2) node[vert,fill=green!30!cyan](2){$2$};
        \draw (33+2*2,0+3*2) node[vert,fill=green!30!cyan](3){$3$};
        \draw (33+3*2,0+3*2) node[vert,fill=green!30!cyan](4){$4$};
        \draw (33+0*2,0+2*2) node[vert,fill=blue!20!cyan](5){$5$};
        \draw (33+1*2,0+2*2) node[vert,fill=blue!40!green](6){$6$};
        \draw (33+2*2,0+2*2) node[vert,fill=blue!40!green](7){$7$};
        \draw (33+3*2,0+2*2) node[vert,fill=blue!40!green](8){$8$};
        \draw (33+0*2,0+1*2) node[vert,fill=blue!40!green](9){$9$};
        \draw (33+1*2,0+1*2) node[vert,fill=blue!40!green](10){$10$};
        \draw (33+2*2,0+1*2) node[vert,fill=blue!40!green](11){$11$};
        \draw (33+3*2,0+1*2) node[vert,fill=blue!40!green](12){$12$};
        \draw (33+0*2,0+0*2) node[vert,fill=blue!40!green](13){$13$};
        \draw (33+1*2,0+0*2) node[vert,fill=blue!40!green](14){$14$};
        \draw (33+2*2,0+0*2) node[vert,fill=blue!40!green](15){$15$};
        \draw (33+3*2,0+0*2) node[vert,fill=blue!40!green](16){$16$};
        %
        \path[every node/.style={font=\sffamily\tiny, fill=white}]
            (1)     edge[eCut]     node{$w_{(1, 2)}$   }     (2)
            (2)     edge[eNotCut]     node{$w_{(2, 3)}$   }     (3)
            (3)     edge[eNotCut]     node{$w_{(3, 4)}$   }     (4)
            (5)     edge[eCut]     node{$w_{(5, 6)}$   }     (6)
            (6)     edge[eNotCut]     node{$w_{(6, 7)}$   }     (7)
            (7)     edge[eNotCut]     node{$w_{(7, 8)}$   }     (8)
            (9)     edge[eNotCut]     node{$w_{(9, 10)}$  }     (10)
            (10)    edge[eNotCut]     node{$w_{(10, 11)}$ }     (11)
            (11)    edge[eNotCut]     node{$w_{(11, 12)}$ }     (12)
            (13)    edge[eNotCut]     node{$w_{(13, 14)}$ }     (14)
            (14)    edge[eNotCut]     node{$w_{(14, 15)}$ }     (15)
            (15)    edge[eNotCut]     node{$w_{(15, 16)}$ }     (16)
            (1)     edge[eNotCut]     node{$w_{(1, 5)}$   }     (5)
            (5)     edge[eCut]     node{$w_{(5, 9)}$   }     (9)
            (9)     edge[eNotCut]     node{$w_{(9, 13)}$  }     (13)
            (2)     edge[eCut]     node{$w_{(2, 6)}$   }     (6)
            (6)     edge[eNotCut]     node{$w_{(6, 10)}$  }     (10)
            (10)    edge[eNotCut]     node{$w_{(10, 14)}$ }     (14)
            (3)     edge[eCut]     node{$w_{(3, 7)}$   }     (7)
            (7)     edge[eNotCut]     node{$w_{(7, 11)}$  }     (11)
            (11)    edge[eNotCut]     node{$w_{(11, 15)}$ }     (15)
            (4)     edge[eCut]     node{$w_{(4, 8)}$   }     (8)
            (8)     edge[eNotCut]     node{$w_{(8, 12)}$  }     (12)
            (12)    edge[eNotCut]     node{$w_{(12, 16)}$ }     (16)
        ;  


        \draw[line width=6pt]     (33+2.5*2,3*2+1) -- (33+2.5*2,3*2+4);
        \draw[line width=6pt, ->] (33+2.5*2,3*2+4) -- (7,3*2+4); 


        \draw[line width=6pt] (8+2.5*2,3*2+1) edge [bend left=50,->]    (13+2.5*2,3*2+1);
        \draw[line width=6pt] (15+2.5*2,3*2+1) edge [bend left=40,->]   (22+2.5*2,3*2+1);        
        \draw[line width=6pt] (23+2.5*2,3*2+1) edge [bend left=40,->]   (31+2.5*2,3*2+1);


        \draw (15.5+0*2, 9) node[font=\sffamily\huge] (dummy){$\textbf{contract}$};
        \draw (23.5+0*2, 9) node[font=\sffamily\huge] (dummy){$\textbf{run CC}$};
        \draw (32.0+0*2, 9) node[font=\sffamily\huge] (dummy){$\textbf{project}$};

        \draw (23.5+0*2, 11) node[font=\sffamily\huge] (dummy){$\textbf{update current best }$};

        \draw (3+0*2, 11) node[font=\sffamily\huge] (dummy){$\textbf{(a) current best }  \bm{y'$}};
        \draw (3+0*2, -5.5) node[font=\sffamily\huge] (dummy){$\textbf{(b) proposal }  \bm{y''$}};
        \draw (11+0*2, -1.5) node[font=\sffamily\huge] (dummy){$ \textbf{(c) } \bm{\hat{y} = y' \cup y''}$};
        \draw (19.5+0*2, -1.5) node[font=\sffamily\huge] (dummy)
            {$ \textbf{(d) contracted graph } \bm{G_{\hat{y}}}$};
        \draw (27.5+0*2, -1.5) node[font=\sffamily\huge] (dummy){$ \textbf{(e) CC on } \bm{G_{\hat{y}}}$};
        \draw (36+0*2, -1.5) node[font=\sffamily\huge] (dummy){$ \textbf{(f) result on } \bm{G}$};

      \end{tikzpicture}
   } 
%\end{subfigure}\quad\quad


\caption{
    To fuse a current best segmentation $y'$  (\textcolor{red}{\ref{fig:move_graph}a})  with a proposal
    segmentation $y''$ (\textcolor{red}{\ref{fig:move_graph}b}) we propose the following algorithm:
    $\hat{y}$ is defined as $y'+y''$ as in \textcolor{red}{\ref{fig:move_graph}c}.
    The contraction graph (\textcolor{red}{\ref{fig:move_graph}d}) $G_{\hat{y}}$ is constructed by
    contracting of all uncut edges in $\hat{y}$.
    The actual fusion move is solving  ~\ref{eq:edgeproblem} for  
    $G_{\hat{y}}$  as in  \textcolor{red}{\ref{fig:move_graph}e}  and project the result back
    to $G$ as in  \textcolor{red}{\ref{fig:move_graph}f}.
    The result of the fusion move is guaranteed to be not worse than $y'$ and $y''$.
    Therefore the current best solution can be updated from the result of
    the fusion move.
    %
    The correlation clustering fusion move algorithm iteratively fuses the current 
    best solution with different proposals.
}\label{fig:move_graph}
\end{figure*}
