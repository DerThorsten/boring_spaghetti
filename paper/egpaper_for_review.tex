\documentclass[10pt,twocolumn,letterpaper]{article}

\usepackage{eso-pic}
\usepackage{cvpr}
\usepackage{times}
\usepackage{epsfig}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}


% Include other packages here, before hyperref.
\usepackage{my_macros}
\usepackage{paralist}
\usepackage{amsthm}
\usepackage{dirtytalk}
%\usepackage{framed}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{algorithm}
%\usepackage{algorithmic}
\usepackage{algpseudocode}
\usepackage{setspace}
%for tikz
\usepackage{tikz,pgfplots}
\usetikzlibrary{arrows,positioning,automata,shadows,fit,shapes}
\usetikzlibrary{arrows,petri,topaths}
\usetikzlibrary{positioning,fit,calc}
\usetikzlibrary{shapes.arrows,chains,decorations.pathreplacing,fadings}
\usepackage{tkz-berge}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\definecolor{shadecolor}{rgb}{0.01,0.199,0.1}

\newtheorem{theorem}{Theorem}

% If you comment hyperref and then uncomment it, you should delete
% egpaper.aux before re-running latex.  (Or just hit 'q' on the first latex
% run, let it finish, and you should be clear).
\usepackage[pagebackref=true,breaklinks=true,letterpaper=true,colorlinks,bookmarks=false]{hyperref}

% \cvprfinalcopy % *** Uncomment this line for the final submission

\def\cvprPaperID{****} % *** Enter the CVPR Paper ID here
\def\httilde{\mbox{\tt\raisebox{-.5ex}{\symbol{126}}}}

% Pages are numbered in submission mode, and unnumbered in camera-ready
\ifcvprfinal\pagestyle{empty}\fi
\begin{document}
%%%%%%%%% TITLE
\include{my_macros.tex}
\title{Correlation Clustering with Dynamic Super-Nodes (DySNCC)}

\author{First Author\\
Institution1\\
Institution1 address\\
{\tt\small firstauthor@i1.org}
% For a paper whose authors are all at the same institution,
% omit the following lines up until the closing ``}''.
% Additional authors and addresses can be added with ``\and'',
% just like the second author.
% To save space, use either the email address or home page, not both
\and
Second Author\\
Institution2\\
First line of institution2 address\\
{\tt\small secondauthor@i2.org}
}

\maketitle
%\thispagestyle{empty}

%%%%%%%%% ABSTRACT
\begin{abstract}
   Multicuts rule.
\end{abstract}
\section{Introduction}
    
  Nunez-Iglesias \etal describe the multicut as
  \say{one-shot agglomeration of supervoxels} whose 
  main drawback is the scalability \cite{nunez_iglesias_2013}.
  Within this work we will overcome the scalability issues.


%-------------------------------------------------------------------------

\subsection{Related Work}


\subsubsection{Multicut Objective}

The multicut / correlation clustering objective 
can be formulated in different ways.



\paragraph{Edge Indicator Variables:}
\begin{center}
    \begin{eqnarray}
        y^* &=& \argmin_{y} \sum_{ e_{ij} \in E } w_{ij} \cdot y_{ij} \\
        s.t.:& & y \in \textit{Multicut Polytope} \nonumber
    \end{eqnarray}
\end{center}

\paragraph{Fully Connected Graph:}
\begin{center}
    \begin{eqnarray}
        y^*   & = & \argmin_{y} \sum_{ i<j \in V } w_{ij} \cdot y_{ij} \\
        s.t.: &  & x_{ij} + x_{jk} < x_{i,k} \quad \forall i, j, k   \nonumber
    \end{eqnarray}
\end{center}

\paragraph{Node Coloring:}
\begin{center}
    \begin{eqnarray}
        l^* &=& \argmin_{L} \sum_{ e_{ij} \in E } w_{ij} \cdot [l_{u} \neq l_{v}] \\
        y_{ij}^* &=& [l_{u} \neq l_{v}]  
    \end{eqnarray}
\end{center}

The multicut objective has been used for
\begin{inparaenum}[(i)]
    \item partitioning a superpixel region adjacency graph~\cite{andres_2011_iccv,kroeger_2012_eccv}
    \item with optional long range repulsive edges~\cite{andres_2013_emmcvpr}.
    \item Alush and Globerger showed how to average multiple segmentations with the multicut objective~\cite{alush_2012_pami}.
    \item Multicuts can also be used for interactive segmentation~\cite{bagon_2011_arxiv},
    \item for co-segmentation~\cite{glassner_2011_cvpr}
    \item and to cluster fully connected graphs~\cite{???}.
\end{inparaenum}


\subsubsection{Solver for the Multicut Objective}
    
    \input{inputs/tab_mc_overview.tex}


   \begin{itemize}
   \item Multicut~\cite{kappes_2011_emmcvpr}
   \item Expand and Explorer~\cite{bagon_2011_arxiv}
   \item Fast Planar CC~\cite{yarkony_2012_eccv}
   \item Break and Conquer \cite{alush_2013_simbad}.
   \item Cut Glue And Cut~\cite{beier_2014_cvpr}
   \end{itemize}

\subsubsection{Fusion Moves}
Move making algorithms, in particular fusion moves, 
have become increasingly popular for energy minimization~\cite{???,kappes_2014_ws}.
For many large scale computer vision applications fusion moves lead to good approximations
with state of the art any time performance~\cite{kappes_2014_ws}.




\subsection{Karger-Stein Algorithms}
Use randomized procedure to reduce the number of nodes / edges to a reasonable 
number.
On the smaller graph, more expensive solvers are used.



%------------------------------------------------------------------------
\section{Intersection Fusion Cut}

Global optimal solvers for multicut do not scale beyond ??? \cite{???}.
Good approximate solvers for planar graphs exist \cite{beier_2014_cvpr,yarkony_2012_eccv} 
but have difficulties to find good solutions for non planar graphs \cite{beier_2014_cvpr}.
%
To make multicuts scalable, it is desirable to replace the graph $G$
with a graph $\hat{G}$, which is smaller in the number of nodes and edges. 
If $\hat{G}$ is small enough, it is feasible to use global optimal solvers.
%
A trivial way to reduce the size of the graph  is edge contraction.
Until a desirable size is reached, one might contract the edge with
the highest weight. A cut on the contracted graph  $\hat{G}$ is always
a valid cut on $\hat{G}$.
%
On the other hand, if an edge $e$ is contracted, it will never be cut.
If $e$ is part of the cut in a global optimal solution, we cannot find
this cut.
%
To overcome this problem  we can randomize the edge contraction,
and repeat this multiple times and remember the best solution.
%
But this would throw away all the ``not the best'' solutions (rewrite me).
Within this work we propose the following nifty trick.
Instead of throwing away solutions, we intersect them with the 
best solution, and solve the multicut on the resulting
graph.
Therefore we fuse multiple solutions,

\begin{theorem}[NameMe]
Solving ??? on the contracted graph is 
equivalent to solving ??? on the 
original graph with additional 
must link constraints
\end{theorem}

\begin{proof}[Proof of theorem ]
todo
\end{proof}



\begin{theorem}[NameMe]
Let $x_{a}$ and $x_{b}$ be two proposal solutions and  $x_{new}$ the solution of \ref{???}.
$x_{new}$  will never decrease the energy:
$x_{new} \cdot w \leq  \min( x_{a}\cdot w,  x_{b}\cdot w) $ 
\end{theorem}

\begin{proof}[Proof of theorem ]
todo
\end{proof}



\begin{theorem}[NameMe]

Let $x_{a}$ and $x_{b}$ be two proposal solutions and  $x_{opt}$ the global solution,
$X_{a}^c, X_{b}^c$ and $ X_{opt}^c$ the set of cut edges in  $x_{a}, x_{b}$  and $ x_{opt}$
optimal solution.
Iff  $ X_{opt}^c \subseteq  (X_{a}^c \cup X_{b}^c)$,  the solution of \ref{???} will be $x_{opt}$.
\end{theorem}

\begin{proof}[Proof of of theorem]
todo
\end{proof}


\input{inputs/fig_alg_graph.tex}

\input{inputs/fig_move_graph.tex}



%-------------------------------------------------------------------------
\subsection{Proposal Generators}


\begin{algorithm}
\begin{scriptsize}
\caption{Fusion Based Algorithms}\label{alg:fusion}
\begin{algorithmic}[1]
\Procedure{Intersection-Based-Inference}{GEN,$J$,$X$}
\State $x^0 \gets \textrm{initial state form } X$
\State $n \gets 0 $                                 \Comment{Number of moves}
\State $m \gets 0 $                                 \Comment{Number of moves without progress}
\While{$m < m_{\max}$ and $n < n_{\max}$ }
\State $n \gets n+1$ 
 \State $x'\gets GEN(x^{n-1},J,X)$                    \Comment{Generate proposal}
 \If{$J(x^{n-1}) \leq J(x')$}                       
   \State $x^{n} \gets Fuse(x^{n-1},x',J)$             
 \Else
   \State $x^{n} \gets Fuse(x',x^{n-1},J)$
 \EndIf
 \If{$J(x^{n}) \leq J(x^{n-1})$}
   \State $m \gets 0$                                 \Comment{Reset counter}
 \Else
   \State $m \gets m+1$                               \Comment{Increment counter}
 \EndIf
\EndWhile
\State \textbf{return} $x^n$
\EndProcedure
\end{algorithmic}
\end{scriptsize}
\end{algorithm}


\begin{algorithm}
\begin{scriptsize}
\caption{Fusion Moves}\label{alg:fusion_moves}
\scriptsize
\begin{algorithmic}[1]
\Require $J(x) \leq J(x')$
\Ensure $J(\hat{x}) \leq J(x)$
\vspace{0.2cm}
\Procedure{Fuse}{$x,x',J$}
\State $\bar{x} \gets \textbf{\scriptsize{Intersect}}(x,x')$  
    \Comment{
        \begin{minipage}{0.4\linewidth} 
            \begin{tiny}
            \begin{singlespace}
                intersect
                uncut edges in $x$ and $x'$,
                return  
                connected component labeling
            \end{singlespace}
            \end{tiny}
        \end{minipage}
    }
\vspace{0.1cm}
\State $ \tilde{G}=(\tilde{E},\tilde{V}),\tilde{W} 
    \gets \textbf{\scriptsize{Contract}}(G,W,\bar{x})$  
    \Comment{ 
        \begin{minipage}{0.2\linewidth} 
            \begin{tiny}
            \begin{singlespace}
                Contract all edges 
                which are uncut in $\bar{x}$ 
            \end{singlespace}
            \end{tiny}
        \end{minipage}
    }
\vspace{0.1cm}
\State $\tilde{x}^*= \argmin\limits_{\tilde{x}} \sum\limits_{e_{ij} \in \tilde{E}} \tilde{w}_{ij}[\tilde{x}_i \neq \tilde{x}_j]$
    \Comment{ 
        \begin{minipage}{0.3\linewidth} 
            \begin{tiny}
            \begin{singlespace}
                Solve the multicut objective
                on smaller graph $\tilde{G}=(\tilde{V},\tilde{E})$
            \end{singlespace}
            \end{tiny}
        \end{minipage}
    }

\State $\hat{x} \gets \textbf{\scriptsize{ProjectBack}}(\tilde{x}^*)$
    \Comment{ 
        \begin{minipage}[\textheight]{0.4\linewidth} 
            \begin{tiny}
            \begin{singlespace}
                Translate the connected component
                labeling $\tilde{x}^*$ of $\tilde{G}$ 
                to a connected component labeling of $G$
            \end{singlespace}
            \end{tiny}
        \end{minipage}
    }
\State \textbf{return} $\hat{x}$
\EndProcedure
\vspace{0.3cm}
\Procedure{FUSE$_{\textrm{BASE}}$}{$x,x',J$}
\State \textbf{return} ${\arg\min}_{\bar{x} \in \{x,x'\}}J(\bar{x})$
\EndProcedure
\end{algorithmic}
\end{scriptsize}
\end{algorithm}



\begin{algorithm}
    \begin{scriptsize}
        \caption{Proposal Generators}\label{alg:proposal_gen}   
        \begin{algorithmic}[1]
            %\Require $J(x) \leq J(x')$
            %\Ensure $J(\hat{x}) \leq J(x)$
            %\vspace{0.3cm}
            \Procedure{Rand2Coloring}{$x,G=(E,V),W$}
            \State $\tilde{W} \gets \textbf{\scriptsize{randomize}}(W) $
            \State $x'= \argmin\limits_{\bar{x}} \sum\limits_{e_{ij} \in E } \tilde{w}_{ij}[\bar{x}_i \neq \bar{x}_j]  [x_i = x_j]   $

            $ \quad\quad s.t.\quad x_i \in \{0, 1\} \forall i $
            \State \textbf{return} $x'$
            \EndProcedure
            %
            %
            \vspace{0.3cm}
            \Procedure{RandEdgeWeightedWatersheds}{$x,G=(E,V),W$}
            \State $\tilde{W} \gets \textbf{\scriptsize{randomize}}(W) $
            \State $ getRandomSeeds$
            \State $ runEdgeWeightedWs$
            \EndProcedure   
            %
            %
            \vspace{0.3cm}
            \Procedure{RandHierarchicalClustering}{$x,G=(E,V),W$}
            \State $\tilde{W} \gets \textbf{\scriptsize{randomize}}(W) $
            \State $\hat{G}=(\hat{E},\hat{V}) \gets G=(E,V)$
            \State $\hat{W} \gets W$
            \While{$|\hat{V}|>\gamma$ \textbf{and}  $\max(\hat{W})>\theta$ }
                \State $\hat{G}=(\hat{E},\hat{V}),\hat{W} \gets 
                    \textbf{\scriptsize{contract}}(\hat{G},\hat{W},  \argmax\limits_{\hat{E}}(\hat{W}) )$
            \EndWhile
            \State $x' \gets \textbf{\scriptsize{getClusterResults}}(???) $ 
            \EndProcedure
        \end{algorithmic}
    \end{scriptsize}
\end{algorithm}




\input{inputs/fig_hc.tex}


%-------------------------------------------------------------------------
\subsection{Fusion Move Solver}


\section{Experiments}
\subsection{Benchmark Models}
\subsection{Pixel-wise Multicuts}
\input{inputs/fig_pixel_mc.tex}


\section{Conclusion}

    



{\small
\bibliographystyle{ieee}
\bibliography{egbib}
}

\end{document}
